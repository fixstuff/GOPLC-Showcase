<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 280">
  <defs>
    <linearGradient id="dpBgGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
    <marker id="dpArrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#4ecdc4"/>
    </marker>
    <marker id="dpArrowOrange" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#f39c12"/>
    </marker>
    <filter id="dpGlow">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="850" height="280" fill="url(#dpBgGrad)" rx="10"/>

  <!-- Title -->
  <text x="425" y="30" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="18" font-weight="bold">
    Failover Data Pipeline
  </text>
  <text x="425" y="48" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="11">
    Time-series data collection for failover timing analysis
  </text>

  <!-- Stage 1: Edge Minions -->
  <g filter="url(#dpGlow)">
    <rect x="30" y="70" width="110" height="80" fill="#222" rx="8" stroke="#ffe66d" stroke-width="1.5"/>
    <text x="85" y="92" text-anchor="middle" fill="#ffe66d" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Edge Minions</text>
    <text x="85" y="112" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">5 per cluster</text>
    <text x="85" y="126" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">CRAC UPS PDU</text>
    <text x="85" y="140" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">GEN FIRE</text>
  </g>

  <!-- Arrow 1 -->
  <line x1="140" y1="110" x2="165" y2="110" stroke="#4ecdc4" stroke-width="2" marker-end="url(#dpArrow)"/>
  <text x="152" y="102" text-anchor="middle" fill="#4ecdc4" font-family="monospace" font-size="7">Unix</text>

  <!-- Stage 2: DataLayer -->
  <g filter="url(#dpGlow)">
    <rect x="170" y="75" width="100" height="70" fill="#222" rx="8" stroke="#00ADD8" stroke-width="1.5"/>
    <text x="220" y="97" text-anchor="middle" fill="#00ADD8" font-family="Arial, sans-serif" font-size="11" font-weight="bold">DataLayer</text>
    <text x="220" y="115" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">TCP publish</text>
    <text x="220" y="130" text-anchor="middle" fill="#4ecdc4" font-family="monospace" font-size="9">&lt;1ms P50</text>
  </g>

  <!-- Arrow 2 -->
  <line x1="270" y1="110" x2="295" y2="110" stroke="#4ecdc4" stroke-width="2" marker-end="url(#dpArrow)"/>

  <!-- Stage 3: Edge Boss -->
  <g filter="url(#dpGlow)">
    <rect x="300" y="75" width="100" height="70" fill="#222" rx="8" stroke="#ff6b6b" stroke-width="1.5"/>
    <text x="350" y="97" text-anchor="middle" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Edge Boss</text>
    <text x="350" y="115" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">DL_GET()</text>
    <text x="350" y="130" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">Aggregation</text>
  </g>

  <!-- Arrow 3 -->
  <line x1="400" y1="110" x2="425" y2="110" stroke="#4ecdc4" stroke-width="2" marker-end="url(#dpArrow)"/>

  <!-- Stage 4: MQTT -->
  <g filter="url(#dpGlow)">
    <rect x="430" y="75" width="100" height="70" fill="#222" rx="8" stroke="#22c55e" stroke-width="1.5"/>
    <text x="480" y="97" text-anchor="middle" fill="#22c55e" font-family="Arial, sans-serif" font-size="11" font-weight="bold">MQTT</text>
    <text x="480" y="115" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">Broker :1883</text>
    <text x="480" y="130" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">QoS 0/1/2</text>
  </g>

  <!-- Arrow 4 -->
  <line x1="530" y1="110" x2="555" y2="110" stroke="#4ecdc4" stroke-width="2" marker-end="url(#dpArrow)"/>

  <!-- Stage 5: Node-RED -->
  <g filter="url(#dpGlow)">
    <rect x="560" y="75" width="100" height="70" fill="#222" rx="8" stroke="#ff6b6b" stroke-width="1.5"/>
    <text x="610" y="97" text-anchor="middle" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Node-RED</text>
    <text x="610" y="115" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">Parse topics</text>
    <text x="610" y="130" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">â†’ Line Proto</text>
  </g>

  <!-- Arrow 5 -->
  <line x1="660" y1="110" x2="685" y2="110" stroke="#4ecdc4" stroke-width="2" marker-end="url(#dpArrow)"/>

  <!-- Stage 6: InfluxDB + Grafana -->
  <g filter="url(#dpGlow)">
    <rect x="690" y="70" width="130" height="85" fill="#222" rx="8" stroke="#a855f7" stroke-width="1.5"/>
    <text x="755" y="92" text-anchor="middle" fill="#a855f7" font-family="Arial, sans-serif" font-size="11" font-weight="bold">InfluxDB</text>
    <text x="755" y="110" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">bucket: goplc</text>
    <line x1="710" y1="120" x2="800" y2="120" stroke="#444" stroke-width="1"/>
    <text x="755" y="138" text-anchor="middle" fill="#f39c12" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Grafana</text>
    <text x="755" y="150" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">Dashboards</text>
  </g>

  <!-- InfluxDB Schema -->
  <rect x="50" y="175" width="750" height="85" fill="#181828" rx="8" stroke="#444" stroke-width="1"/>
  <text x="425" y="195" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="13" font-weight="bold">InfluxDB Measurements</text>

  <rect x="70" y="205" width="220" height="42" fill="#222" rx="5" stroke="#00ADD8" stroke-width="1"/>
  <text x="180" y="222" text-anchor="middle" fill="#00ADD8" font-family="monospace" font-size="10" font-weight="bold">edge_device</text>
  <text x="180" y="240" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">tags: cluster, device</text>

  <rect x="310" y="205" width="220" height="42" fill="#222" rx="5" stroke="#ff6b6b" stroke-width="1"/>
  <text x="420" y="222" text-anchor="middle" fill="#ff6b6b" font-family="monospace" font-size="10" font-weight="bold">edge_boss</text>
  <text x="420" y="240" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">tags: cluster</text>

  <rect x="550" y="205" width="230" height="42" fill="#222" rx="5" stroke="#a855f7" stroke-width="1"/>
  <text x="665" y="222" text-anchor="middle" fill="#a855f7" font-family="monospace" font-size="10" font-weight="bold">sup_state</text>
  <text x="665" y="240" text-anchor="middle" fill="#888" font-family="monospace" font-size="9">failover_count, using_backup</text>

  <!-- Footer -->
  <text x="425" y="275" text-anchor="middle" fill="#555" font-family="Arial, sans-serif" font-size="10">
    ~500ms update rate | Both primary &amp; backup clusters publish independently | Precise failover gap measurement
  </text>
</svg>
